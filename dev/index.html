<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · DelayedKalmanFilter.jl</title><link rel="canonical" href="https://burtonjosh.github.io/DelayedKalmanFilter.jl/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">DelayedKalmanFilter.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DelayedKalmanFilter.jl:-Approximate-likelihood-for-delayed-SDE&#39;s"><a class="docs-heading-anchor" href="#DelayedKalmanFilter.jl:-Approximate-likelihood-for-delayed-SDE&#39;s">DelayedKalmanFilter.jl: Approximate likelihood for delayed SDE&#39;s</a><a id="DelayedKalmanFilter.jl:-Approximate-likelihood-for-delayed-SDE&#39;s-1"></a><a class="docs-heading-anchor-permalink" href="#DelayedKalmanFilter.jl:-Approximate-likelihood-for-delayed-SDE&#39;s" title="Permalink"></a></h1><ul><li><a href="#DelayedKalmanFilter.calculate_current_number_of_states-Tuple{AbstractFloat, DelayedKalmanFilter.TimeConstructor, AbstractFloat}"><code>DelayedKalmanFilter.calculate_current_number_of_states</code></a></li><li><a href="#DelayedKalmanFilter.calculate_final_covariance_matrix-NTuple{4, Any}"><code>DelayedKalmanFilter.calculate_final_covariance_matrix</code></a></li><li><a href="#DelayedKalmanFilter.calculate_log_likelihood_at_parameter_point-Tuple{AbstractArray{&lt;:Real}, Vector{&lt;:AbstractFloat}, Real}"><code>DelayedKalmanFilter.calculate_log_likelihood_at_parameter_point</code></a></li><li><a href="#DelayedKalmanFilter.calculate_steady_state_of_ode-Tuple{Any}"><code>DelayedKalmanFilter.calculate_steady_state_of_ode</code></a></li><li><a href="#DelayedKalmanFilter.distribution_prediction_at_given_time-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Integer, Matrix{&lt;:AbstractFloat}, AbstractFloat}"><code>DelayedKalmanFilter.distribution_prediction_at_given_time</code></a></li><li><a href="#DelayedKalmanFilter.hes_ode!-NTuple{4, Any}"><code>DelayedKalmanFilter.hes_ode!</code></a></li><li><a href="#DelayedKalmanFilter.hill_function-Tuple{Any, Any, Any}"><code>DelayedKalmanFilter.hill_function</code></a></li><li><a href="#DelayedKalmanFilter.initialise_state_space_mean-Tuple{DelayedKalmanFilter.TimeConstructor, Any, Any}"><code>DelayedKalmanFilter.initialise_state_space_mean</code></a></li><li><a href="#DelayedKalmanFilter.initialise_state_space_variance-Tuple{DelayedKalmanFilter.TimeConstructor, Any, Any}"><code>DelayedKalmanFilter.initialise_state_space_variance</code></a></li><li><a href="#DelayedKalmanFilter.kalman_filter-Tuple{Matrix{&lt;:AbstractFloat}, Vector{&lt;:AbstractFloat}, AbstractFloat}"><code>DelayedKalmanFilter.kalman_filter</code></a></li><li><a href="#DelayedKalmanFilter.kalman_filter_state_space_initialisation"><code>DelayedKalmanFilter.kalman_filter_state_space_initialisation</code></a></li><li><a href="#DelayedKalmanFilter.kalman_prediction_step!-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Vector{&lt;:AbstractFloat}, Vector{&lt;:AbstractFloat}}"><code>DelayedKalmanFilter.kalman_prediction_step!</code></a></li><li><a href="#DelayedKalmanFilter.kalman_update_step!-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Vector{&lt;:AbstractFloat}, AbstractFloat, AbstractFloat, Any}"><code>DelayedKalmanFilter.kalman_update_step!</code></a></li><li><a href="#DelayedKalmanFilter.predict_state_space_mean!-NTuple{4, Any}"><code>DelayedKalmanFilter.predict_state_space_mean!</code></a></li><li><a href="#DelayedKalmanFilter.predict_state_space_variance!-NTuple{7, Any}"><code>DelayedKalmanFilter.predict_state_space_variance!</code></a></li><li><a href="#DelayedKalmanFilter.state_space_mean_indexer-NTuple{4, Any}"><code>DelayedKalmanFilter.state_space_mean_indexer</code></a></li><li><a href="#DelayedKalmanFilter.time_constructor_function"><code>DelayedKalmanFilter.time_constructor_function</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.calculate_current_number_of_states-Tuple{AbstractFloat, DelayedKalmanFilter.TimeConstructor, AbstractFloat}" href="#DelayedKalmanFilter.calculate_current_number_of_states-Tuple{AbstractFloat, DelayedKalmanFilter.TimeConstructor, AbstractFloat}"><code>DelayedKalmanFilter.calculate_current_number_of_states</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Calculate the current number of states for a given observation time</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL92-L94">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.calculate_final_covariance_matrix-NTuple{4, Any}" href="#DelayedKalmanFilter.calculate_final_covariance_matrix-NTuple{4, Any}"><code>DelayedKalmanFilter.calculate_final_covariance_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Return the covariance matrix at the current (last predicted) number of states</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL740-L742">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.calculate_log_likelihood_at_parameter_point-Tuple{AbstractArray{&lt;:Real}, Vector{&lt;:AbstractFloat}, Real}" href="#DelayedKalmanFilter.calculate_log_likelihood_at_parameter_point-Tuple{AbstractArray{&lt;:Real}, Vector{&lt;:AbstractFloat}, Real}"><code>DelayedKalmanFilter.calculate_log_likelihood_at_parameter_point</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Calculates the negative log of the likelihood of our data given the paramters, using the Kalman filter. It uses the predicted<em>observation</em>distributions from the kalman_filter function. The entries of this array in the second and third columns represent the probability of the future observation of mRNA and Protein respectively, given our current knowledge.</p><p><strong>Parameters</strong></p><ul><li><p><code>protein_at_observations::</code>: Observed protein. The dimension is n x 2, where n is the   number of observation time points. For each data set, the first column is the time,   and the second column is the observed protein copy number at that time.</p></li><li><p><code>model_parameters::Vector{&lt;:AbstractFloat}</code>: An array containing the model parameters in the   following order: P₀, h, μₘ, μₚ, αₘ, αₚ, τ.</p></li></ul><p>measurement<em>variance : float.     The variance in our measurement. This is given by Sigma</em>e in Calderazzo et. al. (2018).</p><p><strong>Returns</strong></p><p>log_likelihood : float.     The log of the likelihood of the data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/log_likelihood.jl#LL1-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.calculate_steady_state_of_ode-Tuple{Any}" href="#DelayedKalmanFilter.calculate_steady_state_of_ode-Tuple{Any}"><code>DelayedKalmanFilter.calculate_steady_state_of_ode</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Calculate the steady state of the Hes5 ODE system, for a specific set of parameters.</p><p><strong>Arguments</strong></p><ul><li><p><code>P₀::Float64</code></p></li><li><p><code>h::Float64</code></p></li><li><p><code>μₘ::Float64</code></p></li><li><p><code>μₚ::Float64</code></p></li><li><p><code>αₘ::Float64</code></p></li><li><p><code>αₚ::Float64</code></p></li></ul><p><strong>Returns</strong></p><ul><li><code>steady_state_solution::Array{Float64,1}</code>: A 2-element array, giving the steady state for the mRNA and protein respectively.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/hes5_ode_steady_state.jl#LL27-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.distribution_prediction_at_given_time-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Integer, Matrix{&lt;:AbstractFloat}, AbstractFloat}" href="#DelayedKalmanFilter.distribution_prediction_at_given_time-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Integer, Matrix{&lt;:AbstractFloat}, AbstractFloat}"><code>DelayedKalmanFilter.distribution_prediction_at_given_time</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Calculate the mean and variance of the Normal approximation of the state space for a given time point in the Kalman filtering algorithm and return it as a Normal distribution</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL58-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.hes_ode!-NTuple{4, Any}" href="#DelayedKalmanFilter.hes_ode!-NTuple{4, Any}"><code>DelayedKalmanFilter.hes_ode!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Function which defines the HES5 ode system</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/hes5_ode_steady_state.jl#LL1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.hill_function-Tuple{Any, Any, Any}" href="#DelayedKalmanFilter.hill_function-Tuple{Any, Any, Any}"><code>DelayedKalmanFilter.hill_function</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Calculate the Hill function for a given protein molecule number, repression threshold, and hill coefficient.</p><p><strong>Arguments</strong></p><ul><li><p><code>protein::Real</code></p></li><li><p><code>P₀::Real</code></p></li><li><p><code>h::Real</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/hes5_ode_steady_state.jl#LL9-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.initialise_state_space_mean-Tuple{DelayedKalmanFilter.TimeConstructor, Any, Any}" href="#DelayedKalmanFilter.initialise_state_space_mean-Tuple{DelayedKalmanFilter.TimeConstructor, Any, Any}"><code>DelayedKalmanFilter.initialise_state_space_mean</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Initialse the state space mean for a given set of time states and the ODE system&#39;s steady state</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL218-L220">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.initialise_state_space_variance-Tuple{DelayedKalmanFilter.TimeConstructor, Any, Any}" href="#DelayedKalmanFilter.initialise_state_space_variance-Tuple{DelayedKalmanFilter.TimeConstructor, Any, Any}"><code>DelayedKalmanFilter.initialise_state_space_variance</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Initialse the state space variance for a given set of time states and the ODE system&#39;s steady state</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL230-L232">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.kalman_filter-Tuple{Matrix{&lt;:AbstractFloat}, Vector{&lt;:AbstractFloat}, AbstractFloat}" href="#DelayedKalmanFilter.kalman_filter-Tuple{Matrix{&lt;:AbstractFloat}, Vector{&lt;:AbstractFloat}, AbstractFloat}"><code>DelayedKalmanFilter.kalman_filter</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">kalman_filter(
    protein_at_observations::Matrix{&lt;:AbstractFloat},
    model_parameters::Vector{&lt;:AbstractFloat},
    measurement_variance::AbstractFloat,
)</code></pre><p>Perform a delay-adjusted non-linear stochastic Kalman filter based on observation of protein copy numbers. This implements the filter described by Calderazzo et al., Bioinformatics (2018).</p><p><strong>Arguments</strong></p><ul><li><p><code>protein_at_observations::AbstractArray{&lt;:Real}</code>: Observed protein. The dimension is n x 2, where n is the number of observation time points.   The first column is the time, and the second column is the observed protein copy number at   that time. The filter assumes that observations are generated with a fixed, regular time interval.</p></li><li><p><code>model_parameters::ModelParameters</code>: A ModelParameters object containing the model parameters in the following order:   repression threshold, hill coefficient, mRNA degradation rate,protein degradation rate, basal transcription rate,   translation rate, time delay.</p></li><li><p><code>measurement_variance::Real</code>: The variance in our measurement. This is given by Sigma epsilon in Calderazzo et. al. (2018).</p></li></ul><p><strong>Returns</strong></p><ul><li><p><code>state_space_mean::Matrix{&lt;:AbstractFloat}</code>: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively.</p></li><li><p><code>state_space_variance::Matrix{&lt;:AbstractFloat}</code>: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) &lt;= τ, the transcriptional time delay.</p></li><li><p><code>predicted_observation_distributions::Array{Normal{Float64}}</code>: An array of length n, whose entries are Normal distributions with mean and variance   equal to the state space mean and variance predictions for the corresponding time point.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl">julia&gt; using DelayedKalmanFilter

julia&gt; protein = [0. 105.; 10. 100.; 20. 98.]; # times are 0., 10., 20., and protein levels are 105., 100., and 98. respectively

julia&gt; model_parameters = [100.0, 5.0, 0.1, 0.1, 1.0, 1.0, 15.0];

julia&gt; measurement_variance = 1000.0;

julia&gt; ss_mean, ss_var, _, distributions = kalman_filter(
           protein,
           model_parameters,
           measurement_variance
       );

julia&gt; distributions[1]
Distributions.Normal{Float64}(μ=77.80895986786031, σ=93.7064351407417)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL104-L156">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.kalman_filter_state_space_initialisation" href="#DelayedKalmanFilter.kalman_filter_state_space_initialisation"><code>DelayedKalmanFilter.kalman_filter_state_space_initialisation</code></a> — <span class="docstring-category">Function</span></header><section><div><p>A function for initialisation of the state space mean and variance, and update for the &quot;negative&quot; times that are a result of the time delay. Initialises the negative times using the steady state of the deterministic system, and then updates them with kalman<em>update</em>step.</p><p><strong>Arguments</strong></p><ul><li><p><code>protein_at_observations::AbstractArray{&lt;:Real}</code>: Observed protein. The dimension is n x 2, where n is the number of observation time points.   The first column is the time, and the second column is the observed protein copy number at   that time. The filter assumes that observations are generated with a fixed, regular time interval.</p></li><li><p><code>model_parameters::ModelParameters</code>: A ModelParameters object containing the model parameters in the following order:   repression threshold, hill coefficient, mRNA degradation rate,protein degradation rate, basal transcription rate,   translation rate, time delay.</p></li><li><p><code>states::TimeConstructor</code>: A TimeConstructor whose fields define various values relevant to number of states, e.g. discrete<em>delay,   total</em>number<em>of</em>states, etc.</p></li><li><p><code>observation_transform</code>: A 1 x 2 matrix corresponding to the transformation from observed data to molecule number, for mRNA and protein   respectively.</p></li><li><p><code>measurement_variance::Real</code>: The variance in our measurement. This is given by Sigma epsilon in Calderazzo et. al. (2018).</p></li></ul><p><strong>Returns</strong></p><ul><li><p><code>state_space_mean::Matrix{&lt;:AbstractFloat}</code>: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively.</p></li><li><p><code>state_space_variance::Matrix{&lt;:AbstractFloat}</code>: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) &lt;= τ, the transcriptional time delay.</p></li><li><p><code>predicted_observation_distributions::Array{Normal{Float64}}</code>: An array of length n, whose entries are Normal distributions with mean and variance   equal to the state space mean and variance predictions for the corresponding time point.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL263-L296">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.kalman_prediction_step!-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Vector{&lt;:AbstractFloat}, Vector{&lt;:AbstractFloat}}" href="#DelayedKalmanFilter.kalman_prediction_step!-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Vector{&lt;:AbstractFloat}, Vector{&lt;:AbstractFloat}}"><code>DelayedKalmanFilter.kalman_prediction_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Perform the Kalman filter prediction about future observation, based on current knowledge i.e. current state space mean and variance. This gives rho<em>{t+delta t-tau:t+delta t} and P</em>{t+delta t-tau:t+delta t}, using the differential equations in supplementary section 4 of Calderazzo et al., Bioinformatics (2018), approximated using a forward Euler scheme.</p><p><strong>Arguments</strong></p><ul><li><p><code>state_space_mean::Matrix{&lt;:AbstractFloat}</code>: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively.</p></li><li><p><code>state_space_variance::Matrix{&lt;:AbstractFloat}</code>: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) &lt;= τ, the transcriptional time delay.</p></li><li><p><code>states::TimeConstructor</code>: A TimeConstructor whose fields define various values relevant to number of states, e.g. discrete<em>delay,   total</em>number<em>of</em>states, etc.</p></li><li><p><code>current_observation::Vector{&lt;:AbstractFloat}</code>: The current time point and protein observation which acts as the initial condition for the   prediction.</p></li><li><p><code>model_parameters::ModelParameters</code>: A ModelParameters object containing the model parameters in the following order:   repression threshold, hill coefficient, mRNA degradation rate,protein degradation rate, basal transcription rate,   translation rate, time delay.</p></li></ul><p><strong>Returns</strong></p><ul><li><p><code>state_space_mean::Matrix{&lt;:AbstractFloat}</code>: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively. With each prediction new values are saved to the relevant entries in the matrix.</p></li><li><p><code>state_space_variance::Matrix{&lt;:AbstractFloat}</code>: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) &lt;= τ, the transcriptional time delay. With each prediction new values are saved to the relevant entries in the matrix.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL595-L627">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.kalman_update_step!-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Vector{&lt;:AbstractFloat}, AbstractFloat, AbstractFloat, Any}" href="#DelayedKalmanFilter.kalman_update_step!-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Vector{&lt;:AbstractFloat}, AbstractFloat, AbstractFloat, Any}"><code>DelayedKalmanFilter.kalman_update_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Perform the Kalman filter update step on the predicted mean and variance, given a new observation. This implements the equations at the beginning of page 4 in Calderazzo et al., Bioinformatics (2018). This assumes that the observations are collected at fixed time intervals.</p><p><strong>Arguments</strong></p><ul><li><p><code>state_space_mean::Matrix{&lt;:AbstractFloat}</code>: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively.</p></li><li><p><code>state_space_variance::Matrix{&lt;:AbstractFloat}</code>: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) &lt;= τ, the transcriptional time delay.</p></li><li><p><code>states::TimeConstructor</code>: A TimeConstructor whose fields define various values relevant to number of states, e.g. discrete<em>delay,   total</em>number<em>of</em>states, etc.</p></li><li><p><code>current_observation::Vector{&lt;:AbstractFloat}</code>: The current time point and protein observation which acts as the initial condition for the   prediction.</p></li><li><p><code>τ::Real</code>: The time delay parameter, model_parameters[7].</p></li><li><p><code>measurement_variance::Real</code>: The variance which defines the measurement error, it is <span>$Σ_ϵ$</span> in the equation <span>$y = Fx + Σ_ϵ$</span>.</p></li></ul><p><strong>Returns</strong></p><ul><li><p><code>state_space_mean::Matrix{&lt;:AbstractFloat}</code>: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively. At each update step the relevant entries in the matrix are updated according to the update defined in   Calderazzo et al., Bioinformatics (2018).</p></li><li><p><code>state_space_variance::Matrix{&lt;:AbstractFloat}</code>: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) &lt;= τ, the transcriptional time delay. At each update step the relevant entries in the matrix are updated according to the update defined in   Calderazzo et al., Bioinformatics (2018).</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL788-L823">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.predict_state_space_mean!-NTuple{4, Any}" href="#DelayedKalmanFilter.predict_state_space_mean!-NTuple{4, Any}"><code>DelayedKalmanFilter.predict_state_space_mean!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Predict state space mean to the next observation time index</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL355-L357">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.predict_state_space_variance!-NTuple{7, Any}" href="#DelayedKalmanFilter.predict_state_space_variance!-NTuple{7, Any}"><code>DelayedKalmanFilter.predict_state_space_variance!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Predict state space variance to the next observation time index. There are three separate steps in the variance prediction:     (1) integrate P(t,s) to P(t+nΔt,s) for s = t-τ:t, where nΔt is the number of hidden         states. (horizontal/vertical)     (2) Integrate P(t,t) to P(t+nΔt,t+nΔt). (diagonal)     (3) Integrate P(t,t) to P(t,t+nΔt) for t in t:t+nΔt-1. (horizontal/vertical)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL500-L507">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.state_space_mean_indexer-NTuple{4, Any}" href="#DelayedKalmanFilter.state_space_mean_indexer-NTuple{4, Any}"><code>DelayedKalmanFilter.state_space_mean_indexer</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Helper function to return the state space mean for a given (real valued) time between t-τ and t+Δobs, where t is the current number of states.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL43-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DelayedKalmanFilter.time_constructor_function" href="#DelayedKalmanFilter.time_constructor_function"><code>DelayedKalmanFilter.time_constructor_function</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Function which returns an instance of TimeConstructor, which is defines the numbers of states for various uses in the Kalman filter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/burtonjosh/DelayedKalmanFilter.jl/blob/8ec47160b3a32868145b5ccd3e561cb053375b4a/src/kalman_filter_alg.jl#LL11-L14">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 1 August 2022 10:44">Monday 1 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
