var documenterSearchIndex = {"docs":
[{"location":"","page":"Home","title":"Home","text":"CurrentModule = DelayedKalmanFilter","category":"page"},{"location":"#DelayedKalmanFilter","page":"Home","title":"DelayedKalmanFilter","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"Modules = [DelayedKalmanFilter]","category":"page"},{"location":"#DelayedKalmanFilter.calculate_current_number_of_states-Tuple{AbstractFloat, DelayedKalmanFilter.TimeConstructor, AbstractFloat}","page":"Home","title":"DelayedKalmanFilter.calculate_current_number_of_states","text":"Calculate the current number of states for a given observation time\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.calculate_final_covariance_matrix-NTuple{4, Any}","page":"Home","title":"DelayedKalmanFilter.calculate_final_covariance_matrix","text":"Return the covariance matrix at the current (last predicted) number of states\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.calculate_log_likelihood_at_parameter_point-Tuple{AbstractArray{<:Real}, Vector{<:AbstractFloat}, Real}","page":"Home","title":"DelayedKalmanFilter.calculate_log_likelihood_at_parameter_point","text":"Calculates the negative log of the likelihood of our data given the paramters, using the Kalman filter. It uses the predictedobservationdistributions from the kalman_filter function. The entries of this array in the second and third columns represent the probability of the future observation of mRNA and Protein respectively, given our current knowledge.\n\nParameters\n\nprotein_at_observations::: Observed protein. The dimension is n x 2, where n is the   number of observation time points. For each data set, the first column is the time,   and the second column is the observed protein copy number at that time.\nmodel_parameters::Vector{<:AbstractFloat}: An array containing the model parameters in the   following order: P₀, h, μₘ, μₚ, αₘ, αₚ, τ.\n\nmeasurementvariance : float.     The variance in our measurement. This is given by Sigmae in Calderazzo et. al. (2018).\n\nReturns\n\nlog_likelihood : float.     The log of the likelihood of the data.\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.calculate_steady_state_of_ode-Tuple{Any}","page":"Home","title":"DelayedKalmanFilter.calculate_steady_state_of_ode","text":"Calculate the steady state of the Hes5 ODE system, for a specific set of parameters.\n\nArguments\n\nP₀::Float64\nh::Float64\nμₘ::Float64\nμₚ::Float64\nαₘ::Float64\nαₚ::Float64\n\nReturns\n\nsteady_state_solution::Array{Float64,1}: A 2-element array, giving the steady state for the mRNA and protein respectively.\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.distribution_prediction_at_given_time-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Integer, Matrix{<:AbstractFloat}, AbstractFloat}","page":"Home","title":"DelayedKalmanFilter.distribution_prediction_at_given_time","text":"Calculate the mean and variance of the Normal approximation of the state space for a given time point in the Kalman filtering algorithm and return it as a Normal distribution\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.hes_ode!-NTuple{4, Any}","page":"Home","title":"DelayedKalmanFilter.hes_ode!","text":"Function which defines the HES5 ode system\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.hill_function-Tuple{Any, Any, Any}","page":"Home","title":"DelayedKalmanFilter.hill_function","text":"Calculate the Hill function for a given protein molecule number, repression threshold, and hill coefficient.\n\nArguments\n\nprotein::Real\nP₀::Real\nh::Real\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.initialise_state_space_mean-Tuple{DelayedKalmanFilter.TimeConstructor, Any, Any}","page":"Home","title":"DelayedKalmanFilter.initialise_state_space_mean","text":"Initialse the state space mean for a given set of time states and the ODE system's steady state\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.initialise_state_space_variance-Tuple{DelayedKalmanFilter.TimeConstructor, Any, Any}","page":"Home","title":"DelayedKalmanFilter.initialise_state_space_variance","text":"Initialse the state space variance for a given set of time states and the ODE system's steady state\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.kalman_filter-Tuple{Matrix{<:AbstractFloat}, Vector{<:AbstractFloat}, AbstractFloat}","page":"Home","title":"DelayedKalmanFilter.kalman_filter","text":"kalman_filter(\n    protein_at_observations::Matrix{<:AbstractFloat},\n    model_parameters::Vector{<:AbstractFloat},\n    measurement_variance::AbstractFloat,\n)\n\nPerform a delay-adjusted non-linear stochastic Kalman filter based on observation of protein copy numbers. This implements the filter described by Calderazzo et al., Bioinformatics (2018).\n\nArguments\n\nprotein_at_observations::AbstractArray{<:Real}: Observed protein. The dimension is n x 2, where n is the number of observation time points.   The first column is the time, and the second column is the observed protein copy number at   that time. The filter assumes that observations are generated with a fixed, regular time interval.\nmodel_parameters::ModelParameters: A ModelParameters object containing the model parameters in the following order:   repression threshold, hill coefficient, mRNA degradation rate,protein degradation rate, basal transcription rate,   translation rate, time delay.\nmeasurement_variance::Real: The variance in our measurement. This is given by Sigma epsilon in Calderazzo et. al. (2018).\n\nReturns\n\nstate_space_mean::Matrix{<:AbstractFloat}: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively.\nstate_space_variance::Matrix{<:AbstractFloat}: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) <= τ, the transcriptional time delay.\npredicted_observation_distributions::Array{Normal{Float64}}: An array of length n, whose entries are Normal distributions with mean and variance   equal to the state space mean and variance predictions for the corresponding time point.\n\nExample\n\njulia> using DelayedKalmanFilter\n\njulia> protein = [0. 105.; 10. 100.; 20. 98.]; # times are 0., 10., 20., and protein levels are 105., 100., and 98. respectively\n\njulia> model_parameters = [100.0, 5.0, 0.1, 0.1, 1.0, 1.0, 15.0];\n\njulia> measurement_variance = 1000.0;\n\njulia> ss_mean, ss_var, _, distributions = kalman_filter(\n           protein,\n           model_parameters,\n           measurement_variance\n       );\n\njulia> distributions[1]\nDistributions.Normal{Float64}(μ=77.80895986786031, σ=93.7064351407417)\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.kalman_filter_state_space_initialisation","page":"Home","title":"DelayedKalmanFilter.kalman_filter_state_space_initialisation","text":"A function for initialisation of the state space mean and variance, and update for the \"negative\" times that are a result of the time delay. Initialises the negative times using the steady state of the deterministic system, and then updates them with kalmanupdatestep.\n\nArguments\n\nprotein_at_observations::AbstractArray{<:Real}: Observed protein. The dimension is n x 2, where n is the number of observation time points.   The first column is the time, and the second column is the observed protein copy number at   that time. The filter assumes that observations are generated with a fixed, regular time interval.\nmodel_parameters::ModelParameters: A ModelParameters object containing the model parameters in the following order:   repression threshold, hill coefficient, mRNA degradation rate,protein degradation rate, basal transcription rate,   translation rate, time delay.\nstates::TimeConstructor: A TimeConstructor whose fields define various values relevant to number of states, e.g. discretedelay,   totalnumberofstates, etc.\nobservation_transform: A 1 x 2 matrix corresponding to the transformation from observed data to molecule number, for mRNA and protein   respectively.\nmeasurement_variance::Real: The variance in our measurement. This is given by Sigma epsilon in Calderazzo et. al. (2018).\n\nReturns\n\nstate_space_mean::Matrix{<:AbstractFloat}: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively.\nstate_space_variance::Matrix{<:AbstractFloat}: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) <= τ, the transcriptional time delay.\npredicted_observation_distributions::Array{Normal{Float64}}: An array of length n, whose entries are Normal distributions with mean and variance   equal to the state space mean and variance predictions for the corresponding time point.\n\n\n\n\n\n","category":"function"},{"location":"#DelayedKalmanFilter.kalman_prediction_step!-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Vector{<:AbstractFloat}, Vector{<:AbstractFloat}}","page":"Home","title":"DelayedKalmanFilter.kalman_prediction_step!","text":"Perform the Kalman filter prediction about future observation, based on current knowledge i.e. current state space mean and variance. This gives rho{t+delta t-tau:t+delta t} and P{t+delta t-tau:t+delta t}, using the differential equations in supplementary section 4 of Calderazzo et al., Bioinformatics (2018), approximated using a forward Euler scheme.\n\nArguments\n\nstate_space_mean::Matrix{<:AbstractFloat}: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively.\nstate_space_variance::Matrix{<:AbstractFloat}: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) <= τ, the transcriptional time delay.\nstates::TimeConstructor: A TimeConstructor whose fields define various values relevant to number of states, e.g. discretedelay,   totalnumberofstates, etc.\ncurrent_observation::Vector{<:AbstractFloat}: The current time point and protein observation which acts as the initial condition for the   prediction.\nmodel_parameters::ModelParameters: A ModelParameters object containing the model parameters in the following order:   repression threshold, hill coefficient, mRNA degradation rate,protein degradation rate, basal transcription rate,   translation rate, time delay.\n\nReturns\n\nstate_space_mean::Matrix{<:AbstractFloat}: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively. With each prediction new values are saved to the relevant entries in the matrix.\nstate_space_variance::Matrix{<:AbstractFloat}: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) <= τ, the transcriptional time delay. With each prediction new values are saved to the relevant entries in the matrix.\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.kalman_update_step!-Tuple{Any, Any, Any, DelayedKalmanFilter.TimeConstructor, Vector{<:AbstractFloat}, AbstractFloat, AbstractFloat, Any}","page":"Home","title":"DelayedKalmanFilter.kalman_update_step!","text":"Perform the Kalman filter update step on the predicted mean and variance, given a new observation. This implements the equations at the beginning of page 4 in Calderazzo et al., Bioinformatics (2018). This assumes that the observations are collected at fixed time intervals.\n\nArguments\n\nstate_space_mean::Matrix{<:AbstractFloat}: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively.\nstate_space_variance::Matrix{<:AbstractFloat}: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) <= τ, the transcriptional time delay.\nstates::TimeConstructor: A TimeConstructor whose fields define various values relevant to number of states, e.g. discretedelay,   totalnumberofstates, etc.\ncurrent_observation::Vector{<:AbstractFloat}: The current time point and protein observation which acts as the initial condition for the   prediction.\nτ::Real: The time delay parameter, model_parameters[7].\nmeasurement_variance::Real: The variance which defines the measurement error, it is Σ_ϵ in the equation y = Fx + Σ_ϵ.\n\nReturns\n\nstate_space_mean::Matrix{<:AbstractFloat}: An N x 3 matrix, where N is the total number of states. The columns are time, mRNA   and protein respectively. At each update step the relevant entries in the matrix are updated according to the update defined in   Calderazzo et al., Bioinformatics (2018).\nstate_space_variance::Matrix{<:AbstractFloat}: An 2N x 2N matrix where N is the total number of states. It is constructed as a 2 x 2 block   matrix, where the blocks give the covariance of (mRNA, mRNA), (mRNA, protein), (protein, mRNA), and (protein, protein) for all times (t,s) where   abs(t -s) <= τ, the transcriptional time delay. At each update step the relevant entries in the matrix are updated according to the update defined in   Calderazzo et al., Bioinformatics (2018).\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.predict_state_space_mean!-NTuple{4, Any}","page":"Home","title":"DelayedKalmanFilter.predict_state_space_mean!","text":"Predict state space mean to the next observation time index\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.predict_state_space_variance!-NTuple{7, Any}","page":"Home","title":"DelayedKalmanFilter.predict_state_space_variance!","text":"Predict state space variance to the next observation time index. There are three separate steps in the variance prediction:     (1) integrate P(t,s) to P(t+nΔt,s) for s = t-τ:t, where nΔt is the number of hidden         states. (horizontal/vertical)     (2) Integrate P(t,t) to P(t+nΔt,t+nΔt). (diagonal)     (3) Integrate P(t,t) to P(t,t+nΔt) for t in t:t+nΔt-1. (horizontal/vertical)\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.state_space_mean_indexer-NTuple{4, Any}","page":"Home","title":"DelayedKalmanFilter.state_space_mean_indexer","text":"Helper function to return the state space mean for a given (real valued) time between t-τ and t+Δobs, where t is the current number of states.\n\n\n\n\n\n","category":"method"},{"location":"#DelayedKalmanFilter.time_constructor_function","page":"Home","title":"DelayedKalmanFilter.time_constructor_function","text":"Function which returns an instance of TimeConstructor, which is defines the numbers of states for various uses in the Kalman filter.\n\n\n\n\n\n","category":"function"}]
}
